/*
Copyright (c) 2019 WoodNeck
name: css-camera
license: MIT
author: WoodNeck
repository: git+https://github.com/WoodNeck/css-camera.git
version: 0.1.0-snapshot
*/
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t=t||self).CSSCamera=r()}(this,function(){"use strict";function t(n,e){var a,o,i,t,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return t={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function r(r){return function(t){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;u;)try{if(a=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,o=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(!(i=0<(i=u.trys).length&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=e.call(n,u)}catch(t){r=[6,t],o=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,t])}}}function n(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,a,o=n.call(t),i=[];try{for(;(void 0===r||0<r--)&&!(e=o.next()).done;)i.push(e.value)}catch(t){a={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i}function v(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(n(arguments[r]));return t}var F=1e-6,m="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI;function b(){var t=new m(16);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function d(t,r,n,e,a,o,i,u,s,h,c,f,l,M,p,v){var b=new m(16);return b[0]=t,b[1]=r,b[2]=n,b[3]=e,b[4]=a,b[5]=o,b[6]=i,b[7]=u,b[8]=s,b[9]=h,b[10]=c,b[11]=f,b[12]=l,b[13]=M,b[14]=p,b[15]=v,b}function x(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function r(t,r,n){var e=r[0],a=r[1],o=r[2],i=r[3],u=r[4],s=r[5],h=r[6],c=r[7],f=r[8],l=r[9],M=r[10],p=r[11],v=r[12],b=r[13],m=r[14],d=r[15],w=n[0],g=n[1],y=n[2],_=n[3];return t[0]=w*e+g*u+y*f+_*v,t[1]=w*a+g*s+y*l+_*b,t[2]=w*o+g*h+y*M+_*m,t[3]=w*i+g*c+y*p+_*d,w=n[4],g=n[5],y=n[6],_=n[7],t[4]=w*e+g*u+y*f+_*v,t[5]=w*a+g*s+y*l+_*b,t[6]=w*o+g*h+y*M+_*m,t[7]=w*i+g*c+y*p+_*d,w=n[8],g=n[9],y=n[10],_=n[11],t[8]=w*e+g*u+y*f+_*v,t[9]=w*a+g*s+y*l+_*b,t[10]=w*o+g*h+y*M+_*m,t[11]=w*i+g*c+y*p+_*d,w=n[12],g=n[13],y=n[14],_=n[15],t[12]=w*e+g*u+y*f+_*v,t[13]=w*a+g*s+y*l+_*b,t[14]=w*o+g*h+y*M+_*m,t[15]=w*i+g*c+y*p+_*d,t}function w(t,r,n){var e=r[0],a=r[1],o=r[2],i=r[3],u=e+e,s=a+a,h=o+o,c=e*u,f=e*s,l=e*h,M=a*s,p=a*h,v=o*h,b=i*u,m=i*s,d=i*h;return t[0]=1-(M+v),t[1]=f+d,t[2]=l-m,t[3]=0,t[4]=f-d,t[5]=1-(c+v),t[6]=p+b,t[7]=0,t[8]=l+m,t[9]=p-b,t[10]=1-(c+M),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function i(t,r){return t[0]=r[12],t[1]=r[13],t[2]=r[14],t}function g(t,r){var n=r[0]+r[5]+r[10],e=0;return 0<n?(e=2*Math.sqrt(n+1),t[3]=.25*e,t[0]=(r[6]-r[9])/e,t[1]=(r[8]-r[2])/e,t[2]=(r[1]-r[4])/e):r[0]>r[5]&&r[0]>r[10]?(e=2*Math.sqrt(1+r[0]-r[5]-r[10]),t[3]=(r[6]-r[9])/e,t[0]=.25*e,t[1]=(r[1]+r[4])/e,t[2]=(r[8]+r[2])/e):r[5]>r[10]?(e=2*Math.sqrt(1+r[5]-r[0]-r[10]),t[3]=(r[8]-r[2])/e,t[0]=(r[1]+r[4])/e,t[1]=.25*e,t[2]=(r[6]+r[9])/e):(e=2*Math.sqrt(1+r[10]-r[0]-r[5]),t[3]=(r[1]-r[4])/e,t[0]=(r[8]+r[2])/e,t[1]=(r[6]+r[9])/e,t[2]=.25*e),t}function c(t,r){var n=r[0],e=r[1],a=r[2],o=r[3],i=n+n,u=e+e,s=a+a,h=n*i,c=e*i,f=e*u,l=a*i,M=a*u,p=a*s,v=o*i,b=o*u,m=o*s;return t[0]=1-f-p,t[1]=c+m,t[2]=l-b,t[3]=0,t[4]=c-m,t[5]=1-h-p,t[6]=M+v,t[7]=0,t[8]=l+b,t[9]=M-v,t[10]=1-h-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function e(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t[4]=r[4]-n[4],t[5]=r[5]-n[5],t[6]=r[6]-n[6],t[7]=r[7]-n[7],t[8]=r[8]-n[8],t[9]=r[9]-n[9],t[10]=r[10]-n[10],t[11]=r[11]-n[11],t[12]=r[12]-n[12],t[13]=r[13]-n[13],t[14]=r[14]-n[14],t[15]=r[15]-n[15],t}var y={create:b,clone:function(t){var r=new m(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},fromValues:d,set:function(t,r,n,e,a,o,i,u,s,h,c,f,l,M,p,v,b){return t[0]=r,t[1]=n,t[2]=e,t[3]=a,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t[8]=h,t[9]=c,t[10]=f,t[11]=l,t[12]=M,t[13]=p,t[14]=v,t[15]=b,t},identity:x,transpose:function(t,r){if(t===r){var n=r[1],e=r[2],a=r[3],o=r[6],i=r[7],u=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=n,t[6]=r[9],t[7]=r[13],t[8]=e,t[9]=o,t[11]=r[14],t[12]=a,t[13]=i,t[14]=u}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t},invert:function(t,r){var n=r[0],e=r[1],a=r[2],o=r[3],i=r[4],u=r[5],s=r[6],h=r[7],c=r[8],f=r[9],l=r[10],M=r[11],p=r[12],v=r[13],b=r[14],m=r[15],d=n*u-e*i,w=n*s-a*i,g=n*h-o*i,y=e*s-a*u,_=e*h-o*u,x=a*h-o*s,E=c*v-f*p,O=c*b-l*p,P=c*m-M*p,S=f*b-l*v,q=f*m-M*v,R=l*m-M*b,A=d*R-w*q+g*S+y*P-_*O+x*E;return A?(A=1/A,t[0]=(u*R-s*q+h*S)*A,t[1]=(a*q-e*R-o*S)*A,t[2]=(v*x-b*_+m*y)*A,t[3]=(l*_-f*x-M*y)*A,t[4]=(s*P-i*R-h*O)*A,t[5]=(n*R-a*P+o*O)*A,t[6]=(b*g-p*x-m*w)*A,t[7]=(c*x-l*g+M*w)*A,t[8]=(i*q-u*P+h*E)*A,t[9]=(e*P-n*q-o*E)*A,t[10]=(p*_-v*g+m*d)*A,t[11]=(f*g-c*_-M*d)*A,t[12]=(u*O-i*S-s*E)*A,t[13]=(n*S-e*O+a*E)*A,t[14]=(v*w-p*y-b*d)*A,t[15]=(c*y-f*w+l*d)*A,t):null},adjoint:function(t,r){var n=r[0],e=r[1],a=r[2],o=r[3],i=r[4],u=r[5],s=r[6],h=r[7],c=r[8],f=r[9],l=r[10],M=r[11],p=r[12],v=r[13],b=r[14],m=r[15];return t[0]=u*(l*m-M*b)-f*(s*m-h*b)+v*(s*M-h*l),t[1]=-(e*(l*m-M*b)-f*(a*m-o*b)+v*(a*M-o*l)),t[2]=e*(s*m-h*b)-u*(a*m-o*b)+v*(a*h-o*s),t[3]=-(e*(s*M-h*l)-u*(a*M-o*l)+f*(a*h-o*s)),t[4]=-(i*(l*m-M*b)-c*(s*m-h*b)+p*(s*M-h*l)),t[5]=n*(l*m-M*b)-c*(a*m-o*b)+p*(a*M-o*l),t[6]=-(n*(s*m-h*b)-i*(a*m-o*b)+p*(a*h-o*s)),t[7]=n*(s*M-h*l)-i*(a*M-o*l)+c*(a*h-o*s),t[8]=i*(f*m-M*v)-c*(u*m-h*v)+p*(u*M-h*f),t[9]=-(n*(f*m-M*v)-c*(e*m-o*v)+p*(e*M-o*f)),t[10]=n*(u*m-h*v)-i*(e*m-o*v)+p*(e*h-o*u),t[11]=-(n*(u*M-h*f)-i*(e*M-o*f)+c*(e*h-o*u)),t[12]=-(i*(f*b-l*v)-c*(u*b-s*v)+p*(u*l-s*f)),t[13]=n*(f*b-l*v)-c*(e*b-a*v)+p*(e*l-a*f),t[14]=-(n*(u*b-s*v)-i*(e*b-a*v)+p*(e*s-a*u)),t[15]=n*(u*l-s*f)-i*(e*l-a*f)+c*(e*s-a*u),t},determinant:function(t){var r=t[0],n=t[1],e=t[2],a=t[3],o=t[4],i=t[5],u=t[6],s=t[7],h=t[8],c=t[9],f=t[10],l=t[11],M=t[12],p=t[13],v=t[14],b=t[15];return(r*i-n*o)*(f*b-l*v)-(r*u-e*o)*(c*b-l*p)+(r*s-a*o)*(c*v-f*p)+(n*u-e*i)*(h*b-l*M)-(n*s-a*i)*(h*v-f*M)+(e*s-a*u)*(h*p-c*M)},multiply:r,translate:function(t,r,n){var e,a,o,i,u,s,h,c,f,l,M,p,v=n[0],b=n[1],m=n[2];return r===t?(t[12]=r[0]*v+r[4]*b+r[8]*m+r[12],t[13]=r[1]*v+r[5]*b+r[9]*m+r[13],t[14]=r[2]*v+r[6]*b+r[10]*m+r[14],t[15]=r[3]*v+r[7]*b+r[11]*m+r[15]):(e=r[0],a=r[1],o=r[2],i=r[3],u=r[4],s=r[5],h=r[6],c=r[7],f=r[8],l=r[9],M=r[10],p=r[11],t[0]=e,t[1]=a,t[2]=o,t[3]=i,t[4]=u,t[5]=s,t[6]=h,t[7]=c,t[8]=f,t[9]=l,t[10]=M,t[11]=p,t[12]=e*v+u*b+f*m+r[12],t[13]=a*v+s*b+l*m+r[13],t[14]=o*v+h*b+M*m+r[14],t[15]=i*v+c*b+p*m+r[15]),t},scale:function(t,r,n){var e=n[0],a=n[1],o=n[2];return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=r[7]*a,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=r[11]*o,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},rotate:function(t,r,n,e){var a,o,i,u,s,h,c,f,l,M,p,v,b,m,d,w,g,y,_,x,E,O,P,S,q=e[0],R=e[1],A=e[2],j=Math.sqrt(q*q+R*R+A*A);return j<F?null:(q*=j=1/j,R*=j,A*=j,a=Math.sin(n),i=1-(o=Math.cos(n)),u=r[0],s=r[1],h=r[2],c=r[3],f=r[4],l=r[5],M=r[6],p=r[7],v=r[8],b=r[9],m=r[10],d=r[11],w=q*q*i+o,g=R*q*i+A*a,y=A*q*i-R*a,_=q*R*i-A*a,x=R*R*i+o,E=A*R*i+q*a,O=q*A*i+R*a,P=R*A*i-q*a,S=A*A*i+o,t[0]=u*w+f*g+v*y,t[1]=s*w+l*g+b*y,t[2]=h*w+M*g+m*y,t[3]=c*w+p*g+d*y,t[4]=u*_+f*x+v*E,t[5]=s*_+l*x+b*E,t[6]=h*_+M*x+m*E,t[7]=c*_+p*x+d*E,t[8]=u*O+f*P+v*S,t[9]=s*O+l*P+b*S,t[10]=h*O+M*P+m*S,t[11]=c*O+p*P+d*S,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)},rotateX:function(t,r,n){var e=Math.sin(n),a=Math.cos(n),o=r[4],i=r[5],u=r[6],s=r[7],h=r[8],c=r[9],f=r[10],l=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=o*a+h*e,t[5]=i*a+c*e,t[6]=u*a+f*e,t[7]=s*a+l*e,t[8]=h*a-o*e,t[9]=c*a-i*e,t[10]=f*a-u*e,t[11]=l*a-s*e,t},rotateY:function(t,r,n){var e=Math.sin(n),a=Math.cos(n),o=r[0],i=r[1],u=r[2],s=r[3],h=r[8],c=r[9],f=r[10],l=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=o*a-h*e,t[1]=i*a-c*e,t[2]=u*a-f*e,t[3]=s*a-l*e,t[8]=o*e+h*a,t[9]=i*e+c*a,t[10]=u*e+f*a,t[11]=s*e+l*a,t},rotateZ:function(t,r,n){var e=Math.sin(n),a=Math.cos(n),o=r[0],i=r[1],u=r[2],s=r[3],h=r[4],c=r[5],f=r[6],l=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=o*a+h*e,t[1]=i*a+c*e,t[2]=u*a+f*e,t[3]=s*a+l*e,t[4]=h*a-o*e,t[5]=c*a-i*e,t[6]=f*a-u*e,t[7]=l*a-s*e,t},fromTranslation:function(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},fromScaling:function(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=r[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotation:function(t,r,n){var e,a,o,i=n[0],u=n[1],s=n[2],h=Math.sqrt(i*i+u*u+s*s);return h<F?null:(i*=h=1/h,u*=h,s*=h,e=Math.sin(r),o=1-(a=Math.cos(r)),t[0]=i*i*o+a,t[1]=u*i*o+s*e,t[2]=s*i*o-u*e,t[3]=0,t[4]=i*u*o-s*e,t[5]=u*u*o+a,t[6]=s*u*o+i*e,t[7]=0,t[8]=i*s*o+u*e,t[9]=u*s*o-i*e,t[10]=s*s*o+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromXRotation:function(t,r){var n=Math.sin(r),e=Math.cos(r);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromYRotation:function(t,r){var n=Math.sin(r),e=Math.cos(r);return t[0]=e,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:function(t,r){var n=Math.sin(r),e=Math.cos(r);return t[0]=e,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotationTranslation:w,fromQuat2:function(t,r){var n=new m(3),e=-r[0],a=-r[1],o=-r[2],i=r[3],u=r[4],s=r[5],h=r[6],c=r[7],f=e*e+a*a+o*o+i*i;return 0<f?(n[0]=2*(u*i+c*e+s*o-h*a)/f,n[1]=2*(s*i+c*a+h*e-u*o)/f,n[2]=2*(h*i+c*o+u*a-s*e)/f):(n[0]=2*(u*i+c*e+s*o-h*a),n[1]=2*(s*i+c*a+h*e-u*o),n[2]=2*(h*i+c*o+u*a-s*e)),w(t,r,n),t},getTranslation:i,getScaling:function(t,r){var n=r[0],e=r[1],a=r[2],o=r[4],i=r[5],u=r[6],s=r[8],h=r[9],c=r[10];return t[0]=Math.sqrt(n*n+e*e+a*a),t[1]=Math.sqrt(o*o+i*i+u*u),t[2]=Math.sqrt(s*s+h*h+c*c),t},getRotation:g,fromRotationTranslationScale:function(t,r,n,e){var a=r[0],o=r[1],i=r[2],u=r[3],s=a+a,h=o+o,c=i+i,f=a*s,l=a*h,M=a*c,p=o*h,v=o*c,b=i*c,m=u*s,d=u*h,w=u*c,g=e[0],y=e[1],_=e[2];return t[0]=(1-(p+b))*g,t[1]=(l+w)*g,t[2]=(M-d)*g,t[3]=0,t[4]=(l-w)*y,t[5]=(1-(f+b))*y,t[6]=(v+m)*y,t[7]=0,t[8]=(M+d)*_,t[9]=(v-m)*_,t[10]=(1-(f+p))*_,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},fromRotationTranslationScaleOrigin:function(t,r,n,e,a){var o=r[0],i=r[1],u=r[2],s=r[3],h=o+o,c=i+i,f=u+u,l=o*h,M=o*c,p=o*f,v=i*c,b=i*f,m=u*f,d=s*h,w=s*c,g=s*f,y=e[0],_=e[1],x=e[2],E=a[0],O=a[1],P=a[2],S=(1-(v+m))*y,q=(M+g)*y,R=(p-w)*y,A=(M-g)*_,j=(1-(l+m))*_,T=(b+d)*_,C=(p+w)*x,F=(b-d)*x,I=(1-(l+v))*x;return t[0]=S,t[1]=q,t[2]=R,t[3]=0,t[4]=A,t[5]=j,t[6]=T,t[7]=0,t[8]=C,t[9]=F,t[10]=I,t[11]=0,t[12]=n[0]+E-(S*E+A*O+C*P),t[13]=n[1]+O-(q*E+j*O+F*P),t[14]=n[2]+P-(R*E+T*O+I*P),t[15]=1,t},fromQuat:c,frustum:function(t,r,n,e,a,o,i){var u=1/(n-r),s=1/(a-e),h=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(n+r)*u,t[9]=(a+e)*s,t[10]=(i+o)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*h,t[15]=0,t},perspective:function(t,r,n,e,a){var o,i=1/Math.tan(r/2);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(o=1/(e-a),t[10]=(a+e)*o,t[14]=2*a*e*o):(t[10]=-1,t[14]=-2*e),t},perspectiveFromFieldOfView:function(t,r,n,e){var a=Math.tan(r.upDegrees*Math.PI/180),o=Math.tan(r.downDegrees*Math.PI/180),i=Math.tan(r.leftDegrees*Math.PI/180),u=Math.tan(r.rightDegrees*Math.PI/180),s=2/(i+u),h=2/(a+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-(i-u)*s*.5,t[9]=(a-o)*h*.5,t[10]=e/(n-e),t[11]=-1,t[12]=0,t[13]=0,t[14]=e*n/(n-e),t[15]=0,t},ortho:function(t,r,n,e,a,o,i){var u=1/(r-n),s=1/(e-a),h=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(r+n)*u,t[13]=(a+e)*s,t[14]=(i+o)*h,t[15]=1,t},lookAt:function(t,r,n,e){var a,o,i,u,s,h,c,f,l,M,p=r[0],v=r[1],b=r[2],m=e[0],d=e[1],w=e[2],g=n[0],y=n[1],_=n[2];return Math.abs(p-g)<F&&Math.abs(v-y)<F&&Math.abs(b-_)<F?x(t):(c=p-g,f=v-y,l=b-_,a=d*(l*=M=1/Math.sqrt(c*c+f*f+l*l))-w*(f*=M),o=w*(c*=M)-m*l,i=m*f-d*c,(M=Math.sqrt(a*a+o*o+i*i))?(a*=M=1/M,o*=M,i*=M):i=o=a=0,u=f*i-l*o,s=l*a-c*i,h=c*o-f*a,(M=Math.sqrt(u*u+s*s+h*h))?(u*=M=1/M,s*=M,h*=M):h=s=u=0,t[0]=a,t[1]=u,t[2]=c,t[3]=0,t[4]=o,t[5]=s,t[6]=f,t[7]=0,t[8]=i,t[9]=h,t[10]=l,t[11]=0,t[12]=-(a*p+o*v+i*b),t[13]=-(u*p+s*v+h*b),t[14]=-(c*p+f*v+l*b),t[15]=1,t)},targetTo:function(t,r,n,e){var a=r[0],o=r[1],i=r[2],u=e[0],s=e[1],h=e[2],c=a-n[0],f=o-n[1],l=i-n[2],M=c*c+f*f+l*l;0<M&&(c*=M=1/Math.sqrt(M),f*=M,l*=M);var p=s*l-h*f,v=h*c-u*l,b=u*f-s*c;return 0<(M=p*p+v*v+b*b)&&(p*=M=1/Math.sqrt(M),v*=M,b*=M),t[0]=p,t[1]=v,t[2]=b,t[3]=0,t[4]=f*b-l*v,t[5]=l*p-c*b,t[6]=c*v-f*p,t[7]=0,t[8]=c,t[9]=f,t[10]=l,t[11]=0,t[12]=a,t[13]=o,t[14]=i,t[15]=1,t},str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},frob:function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},add:function(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t[4]=r[4]+n[4],t[5]=r[5]+n[5],t[6]=r[6]+n[6],t[7]=r[7]+n[7],t[8]=r[8]+n[8],t[9]=r[9]+n[9],t[10]=r[10]+n[10],t[11]=r[11]+n[11],t[12]=r[12]+n[12],t[13]=r[13]+n[13],t[14]=r[14]+n[14],t[15]=r[15]+n[15],t},subtract:e,multiplyScalar:function(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=r[7]*n,t[8]=r[8]*n,t[9]=r[9]*n,t[10]=r[10]*n,t[11]=r[11]*n,t[12]=r[12]*n,t[13]=r[13]*n,t[14]=r[14]*n,t[15]=r[15]*n,t},multiplyScalarAndAdd:function(t,r,n,e){return t[0]=r[0]+n[0]*e,t[1]=r[1]+n[1]*e,t[2]=r[2]+n[2]*e,t[3]=r[3]+n[3]*e,t[4]=r[4]+n[4]*e,t[5]=r[5]+n[5]*e,t[6]=r[6]+n[6]*e,t[7]=r[7]+n[7]*e,t[8]=r[8]+n[8]*e,t[9]=r[9]+n[9]*e,t[10]=r[10]+n[10]*e,t[11]=r[11]+n[11]*e,t[12]=r[12]+n[12]*e,t[13]=r[13]+n[13]*e,t[14]=r[14]+n[14]*e,t[15]=r[15]+n[15]*e,t},exactEquals:function(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]&&t[9]===r[9]&&t[10]===r[10]&&t[11]===r[11]&&t[12]===r[12]&&t[13]===r[13]&&t[14]===r[14]&&t[15]===r[15]},equals:function(t,r){var n=t[0],e=t[1],a=t[2],o=t[3],i=t[4],u=t[5],s=t[6],h=t[7],c=t[8],f=t[9],l=t[10],M=t[11],p=t[12],v=t[13],b=t[14],m=t[15],d=r[0],w=r[1],g=r[2],y=r[3],_=r[4],x=r[5],E=r[6],O=r[7],P=r[8],S=r[9],q=r[10],R=r[11],A=r[12],j=r[13],T=r[14],C=r[15];return Math.abs(n-d)<=F*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(e-w)<=F*Math.max(1,Math.abs(e),Math.abs(w))&&Math.abs(a-g)<=F*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-y)<=F*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(i-_)<=F*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(u-x)<=F*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(s-E)<=F*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(h-O)<=F*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(c-P)<=F*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(f-S)<=F*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(l-q)<=F*Math.max(1,Math.abs(l),Math.abs(q))&&Math.abs(M-R)<=F*Math.max(1,Math.abs(M),Math.abs(R))&&Math.abs(p-A)<=F*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(v-j)<=F*Math.max(1,Math.abs(v),Math.abs(j))&&Math.abs(b-T)<=F*Math.max(1,Math.abs(b),Math.abs(T))&&Math.abs(m-C)<=F*Math.max(1,Math.abs(m),Math.abs(C))},mul:r,sub:e};function _(){var t=new m(3);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function E(t,r,n){var e=new m(3);return e[0]=t,e[1]=r,e[2]=n,e}function O(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t}function a(t,r,n){var e=r[0],a=r[1],o=r[2],i=n[0],u=n[1],s=n[2];return t[0]=a*s-o*u,t[1]=o*i-e*s,t[2]=e*u-a*i,t}function P(t,r,n){var e=n[0],a=n[1],o=n[2],i=n[3],u=r[0],s=r[1],h=r[2],c=a*h-o*s,f=o*u-e*h,l=e*s-a*u,M=a*l-o*f,p=o*c-e*l,v=e*f-a*c,b=2*i;return c*=b,f*=b,l*=b,M*=2,p*=2,v*=2,t[0]=u+c+M,t[1]=s+f+p,t[2]=h+l+v,t}var o,S=function(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t},u=function(t){var r=t[0],n=t[1],e=t[2];return Math.sqrt(r*r+n*n+e*e)};o=_();var s;s=function(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}();function q(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function h(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function f(t,r,n){n*=.5;var e=Math.sin(n);return t[0]=e*r[0],t[1]=e*r[1],t[2]=e*r[2],t[3]=Math.cos(n),t}function l(t,r,n){var e=r[0],a=r[1],o=r[2],i=r[3],u=n[0],s=n[1],h=n[2],c=n[3];return t[0]=e*c+i*u+a*h-o*s,t[1]=a*c+i*s+o*u-e*h,t[2]=o*c+i*h+e*s-a*u,t[3]=i*c-e*u-a*s-o*h,t}function M(t,r,n,e){var a,o,i,u,s,h=r[0],c=r[1],f=r[2],l=r[3],M=n[0],p=n[1],v=n[2],b=n[3];return(o=h*M+c*p+f*v+l*b)<0&&(o=-o,M=-M,p=-p,v=-v,b=-b),s=F<1-o?(a=Math.acos(o),i=Math.sin(a),u=Math.sin((1-e)*a)/i,Math.sin(e*a)/i):(u=1-e,e),t[0]=u*h+s*M,t[1]=u*c+s*p,t[2]=u*f+s*v,t[3]=u*l+s*b,t}function R(t,r){var n=r[0],e=r[1],a=r[2],o=r[3],i=n*n+e*e+a*a+o*o,u=i?1/i:0;return t[0]=-n*u,t[1]=-e*u,t[2]=-a*u,t[3]=o*u,t}function p(t,r){var n,e=r[0]+r[4]+r[8];if(0<e)n=Math.sqrt(e+1),t[3]=.5*n,n=.5/n,t[0]=(r[5]-r[7])*n,t[1]=(r[6]-r[2])*n,t[2]=(r[1]-r[3])*n;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[3*a+a]&&(a=2);var o=(a+1)%3,i=(a+2)%3;n=Math.sqrt(r[3*a+a]-r[3*o+o]-r[3*i+i]+1),t[a]=.5*n,n=.5/n,t[3]=(r[3*o+i]-r[3*i+o])*n,t[o]=(r[3*o+a]+r[3*a+o])*n,t[i]=(r[3*i+a]+r[3*a+i])*n}return t}function A(t,r,n,e){var a=.5*Math.PI/180;r*=a,n*=a,e*=a;var o=Math.sin(r),i=Math.cos(r),u=Math.sin(n),s=Math.cos(n),h=Math.sin(e),c=Math.cos(e);return t[0]=o*s*c-i*u*h,t[1]=i*u*c+o*s*h,t[2]=i*s*h-o*u*c,t[3]=i*s*c+o*u*h,t}var j,T,C,I,W,D,V=function(t,r,n,e){var a=new m(4);return a[0]=t,a[1]=r,a[2]=n,a[3]=e,a},L=l,N=function(t,r){var n=r[0],e=r[1],a=r[2],o=r[3],i=n*n+e*e+a*a+o*o;return 0<i&&(i=1/Math.sqrt(i)),t[0]=n*i,t[1]=e*i,t[2]=a*i,t[3]=o*i,t};j=_(),T=E(1,0,0),C=E(0,1,0),I=q(),W=q(),D=function(){var t=new m(9);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}();function k(t,r){if("string"==typeof t){var n=r?r.querySelector(t):document.querySelector(t);if(!n)throw new Error(function(t){return'Element with selector "'+t+"\" doesn't exist."}(t));return n}if(t.nodeName&&1===t.nodeType)return t;throw new Error(function(t){return"Element should be provided in string or HTMLElement. Received: "+t}(t))}var Z;Z=function(){var t=new m(2);return m!=Float32Array&&(t[0]=0,t[1]=0),t}();function H(r,n){Object.keys(n).forEach(function(t){r.style[t]=n[t]})}function X(t){var r=b();c(r,t);var n=r[0],e=r[4],a=r[1],o=r[5],i=r[2],u=r[6],s=r[10],h=_();return h[1]=Math.asin(-function(t,r,n){return Math.max(Math.min(t,n),r)}(i,-1,1)),Math.abs(i)<.99999?(h[0]=Math.atan2(u,s),h[2]=Math.atan2(a,n)):(h[0]=0,h[2]=Math.atan2(-e,o)),h.map(function(t){return function(t){return 180*t/Math.PI}(t)})}var Y,Q={VIEWPORT:{width:"100%",height:"100%","transform-style":"preserve-3d",overflow:"hidden"},CAMERA:{width:"100%",height:"100%","transform-style":"preserve-3d","will-change":"transform"},WORLD:{width:"100%",height:"100%","transform-style":"preserve-3d","will-change":"transform"}},B={VIEWPORT:"cc-viewport",CAMERA:"cc-camera",WORLD:"cc-world"};function G(t){this._element=k(t),this._position=_(),this._scale=E(1,1,1),this._rotation=_(),this._perspective=0,this._perspectiveOffset=0;var r=this._element,n=document.createElement("div"),e=n.cloneNode(),a=n.cloneNode();n.className=B.VIEWPORT,e.className=B.CAMERA,a.className=B.WORLD,H(n,Q.VIEWPORT),H(e,Q.CAMERA),H(a,Q.WORLD),e.appendChild(a),n.appendChild(e),this._viewportEl=n,this._cameraEl=e,this._worldEl=a,r.parentElement.insertBefore(n,r),a.appendChild(r)}return Y=G.prototype,Object.defineProperty(G,"VERSION",{get:function(){return"0.1.0-snapshot"},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"viewportEl",{get:function(){return this._viewportEl},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"cameraEl",{get:function(){return this._cameraEl},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"worldEl",{get:function(){return this._worldEl},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"position",{get:function(){return v(this._position)},set:function(t){this._position=E(t[0],t[1],t[2])},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"scale",{get:function(){return v(this._scale)},set:function(t){this._scale=E(t[0],t[1],t[2])},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"rotation",{get:function(){return v(this._rotation)},set:function(t){this._rotation=E(t[0],t[1],t[2])},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"quaternion",{get:function(){var t=this._rotation;return v(A(q(),t[0],t[1],t[2]))},set:function(t){this._rotation=X(V(t[0],t[1],t[2],t[3]))},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"perspective",{get:function(){return this._perspective},set:function(t){this._perspective=t},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"perspectiveOffset",{get:function(){return this._perspectiveOffset},set:function(t){this._perspectiveOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"cameraCSS",{get:function(){var t=this._perspective,r=this._perspectiveOffset,n=this._rotation,e=this._scale;return"scale3d("+e[0]+", "+e[1]+", "+e[2]+") translateZ("+(t+r)+"px) rotateX("+n[0]+"deg) rotateY("+n[1]+"deg) rotateZ("+n[2]+"deg)"},enumerable:!0,configurable:!0}),Object.defineProperty(Y,"worldCSS",{get:function(){var t=this._position;return"translate3d("+-t[0]+"px, "+-t[1]+"px, "+-t[2]+"px)"},enumerable:!0,configurable:!0}),Y.focus=function(t){var r=k(t),n=this._getFocusMatrix(r),e=q(),a=_();g(e,n),i(a,n);var o=X(e);return function(t,r){t[0]=-r[0],t[1]=-r[1],t[2]=-r[2]}(o,o),this._rotation=o,this._position=a,this},Y.translateLocal=function(t,r,n){void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0);var e=this._position,a=this._rotation,o=E(t,r,n),i=q();return A(i,-a[0],-a[1],-a[2]),P(o,o,i),O(e,e,o),this},Y.translate=function(t,r,n){return void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),O(this._position,this._position,E(t,r,n)),this},Y.rotate=function(t,r,n){return void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),O(this._rotation,this._rotation,E(t,r,n)),this},Y.update=function(n){return void 0===n&&(n=0),function(o,i,u,s){return new(u||(u=Promise))(function(t,r){function n(t){try{a(s.next(t))}catch(t){r(t)}}function e(t){try{a(s.throw(t))}catch(t){r(t)}}function a(r){r.done?t(r.value):new u(function(t){t(r.value)}).then(n,e)}a((s=s.apply(o,i||[])).next())})}(this,void 0,Promise,function(){var r;return t(this,function(t){return r=0<n?"transform "+n+"ms":"",H(this._viewportEl,{perspective:this.perspective+"px"}),H(this._cameraEl,{transition:r,transform:this.cameraCSS}),H(this._worldEl,{transition:r,transform:this.worldCSS}),[2,new Promise(function(t){setTimeout(function(){t()},n)})]})})},Y._getFocusMatrix=function(t){for(var f=[];t&&(f.push(t),t!==this._element);)t=t.parentElement;f.reverse();var r=f.map(function(t){return window.getComputedStyle(t)}),n=function(t,r){for(var n=0;n<t.length;n+=1){var e=t[n];if(e&&r(e))return n}return-1}(r,function(t){return"preserve-3d"!==t.transformStyle});0<n&&r.splice(n+1);var l={left:0,top:0,width:this.viewportEl.offsetWidth,height:this.viewportEl.offsetHeight},M=h(q()),p=E(0,0,0);r.forEach(function(t,r){var n=f[r],e={left:n.offsetLeft,top:n.offsetTop,width:n.offsetWidth,height:n.offsetHeight},a=function(t){var r=t.getPropertyValue("transform"),n=/\(((\s|\S)+)\)/.exec(r),e=n?n[1].split(",").map(function(t){return parseFloat(t)}):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];if(16===e.length)return d.apply(y,v(e));var a=b();return x(a),a[0]=e[0],a[1]=e[1],a[4]=e[2],a[5]=e[3],a[12]=e[4],a[13]=e[5],a}(t),o=function(t,r){return E(t.left+(t.width-r.width)/2,t.top+(t.height-r.height)/2,0)}(e,l);P(o,o,M),O(p,p,o);var i=function(t,r){var n=t.transformOrigin.split(" ").map(function(t){return parseFloat(t.substring(0,t.length-2))});return E(n[0]-r.width/2,n[1]-r.height/2,0)}(t,e);P(i,i,M);var u=function(t){var r=new m(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}(p);O(u,u,i);var s=_();S(s,p,u),P(s,s,R(q(),M)),function(t,r,n){var e=r[0],a=r[1],o=r[2],i=n[3]*e+n[7]*a+n[11]*o+n[15];i=i||1,t[0]=(n[0]*e+n[4]*a+n[8]*o+n[12])/i,t[1]=(n[1]*e+n[5]*a+n[9]*o+n[13])/i,t[2]=(n[2]*e+n[6]*a+n[10]*o+n[14])/i}(s,s,a),P(s,s,M);var h=O(_(),u,s),c=g(q(),a);!function(t,r){t[0]=r[0],t[1]=r[1],t[2]=r[2]}(p,h),L(M,M,c),l=e});var e=E(0,0,this.perspective);P(e,e,M),O(p,p,e);var a=b();return w(a,M,p),a},G});
//# sourceMappingURL=css-camera.pkgd.min.js.map
