!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("gl-matrix")):"function"==typeof define&&define.amd?define(["gl-matrix"],t):(e=e||self).CSSCamera=t(e.glMatrix)}(this,function(a){"use strict";var e,i=(e=t.prototype,Object.defineProperty(e,"position",{get:function(){return this._position},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scale",{get:function(){return this._scale},enumerable:!0,configurable:!0}),Object.defineProperty(e,"rotation",{get:function(){return this._rotation},enumerable:!0,configurable:!0}),Object.defineProperty(e,"perspective",{get:function(){return this._perspective},set:function(e){this._perspective=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cameraCSS",{get:function(){var e=this._perspective,t=this._rotation;return"translateZ("+e+"px) rotateY("+t[1]+"deg) rotateZ("+t[2]+"deg) rotateX("+t[0]+"deg)"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"worldCSS",{get:function(){var e=this._perspective,t=this._position;return"translate3d("+-t[0]+"px, "+-t[1]+"px, "+(-t[2]-e)+"px)"},enumerable:!0,configurable:!0}),e.translate=function(e,t,r){var n=a.vec3.fromValues(e,t,r),o=this._rotation,i=a.quat.create();a.quat.fromEuler(i,o[0],o[1],o[2]),a.quat.invert(i,i),a.vec3.transformQuat(n,n,i),a.vec3.add(this._position,this._position,n)},e.absTranslate=function(e,t,r){a.vec3.add(this._position,this._position,a.vec3.fromValues(e,t,r))},e.rotateX=function(e){this._rotation[0]+=e},e.rotateY=function(e){this._rotation[1]+=e},e.rotateZ=function(e){this._rotation[2]+=e},t);function t(){this._position=a.vec3.create(),this._scale=a.vec3.fromValues(1,1,1),this._rotation=a.vec3.create(),this._perspective=0}function s(t,r){Object.keys(r).forEach(function(e){t.style[e]=r[e]})}var r,c={width:"100%",height:"100%","transform-style":"preserve-3d"},u={VIEWPORT:"cc-viewport",CAMERA:"cc-camera",WORLD:"cc-world"},l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function n(e){this._element=function(e){if("string"==typeof e){var t=document.querySelector(e);if(!t)throw new Error("Base element doesn't exist.");return t}if(e.nodeName&&1===e.nodeType)return e;throw new Error("Element should be provided in string or HTMLElement.")}(e),this._transform=new i;var t=this._element,r=document.createElement("div");s(r,c);var n=r.cloneNode(),o=r.cloneNode();r.className=u.VIEWPORT,n.className=u.CAMERA,o.className=u.WORLD,n.appendChild(o),r.appendChild(n),this._viewportEl=r,this._cameraEl=n,this._worldEl=o,t.parentElement.insertBefore(r,t),o.appendChild(t)}return r=n.prototype,Object.defineProperty(r,"transform",{get:function(){return this._transform},enumerable:!0,configurable:!0}),Object.defineProperty(r,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(r,"viewportEl",{get:function(){return this._viewportEl},enumerable:!0,configurable:!0}),Object.defineProperty(r,"cameraEl",{get:function(){return this._cameraEl},enumerable:!0,configurable:!0}),r.focus=function(e,t){void 0===t&&(t=l);var r=this.getFocusMatrix(e,t);console.log(r)},r.getFocusMatrix=function(e,t){void 0===t&&(t=l);for(var r=[];e&&(r.push(e),e!==this._element);)e=e.parentElement;r.reverse();var n=r.map(function(e){return window.getComputedStyle(e)}),o=function(e,t){for(var r=0;r<e.length;r+=1){var n=e[r];if(n&&t(n))return r}return-1}(n,function(e){return"preserve-3d"!==e.transformStyle});0<=o&&n.splice(o+1);var i=a.mat4.fromValues.apply(a.mat4,t);return n.forEach(function(e){i=a.mat4.mul(i,i,function(e){var t=e.getPropertyValue("transform"),r=/\(((\s|\S)+)\)/.exec(t),n=r?r[1].split(",").map(function(e){return parseFloat(e)}):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return a.mat4.fromValues.apply(a.mat4,n)}(e))}),i},r.setPerspective=function(e){s(this._viewportEl,{perspective:e+"px"}),this._transform.perspective=e,this.update()},r.update=function(){var e=this._transform;this._cameraEl.style.transform=e.cameraCSS,this._worldEl.style.transform=e.worldCSS},n});
//# sourceMappingURL=css-camera.min.js.map
